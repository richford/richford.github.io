---
import Layout from "../layouts/Layout.astro";
import { cv } from "../data/cv";
import "../styles/cv-print.css";

function highlightName(authors: string): string {
  return authors.replace(
    /Richie-Halford A/g,
    '<strong class="text-slate-100 print:text-black">Richie-Halford A</strong>'
  );
}
---

<Layout title="CV â€” Adam Richie-Halford" description="Curriculum vitae of Adam Richie-Halford.">
  <article class="cv-page max-w-4xl mx-auto px-6 py-16 sm:py-24">

    <!-- Header -->
    <header class="cv-header mb-12">
      <h1 class="text-3xl sm:text-4xl font-bold text-slate-50 mb-2 print:text-black">
        {cv.name}
      </h1>
      <p class="text-lg text-accent mb-4 print:text-gray-600">{cv.title}</p>
      <div class="hidden print:flex flex-wrap gap-x-5 gap-y-1 text-sm text-gray-600">
        {cv.contact.emails.map((email) => (
          <a href={`mailto:${email}`} class="inline-flex items-center gap-1 text-gray-700">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" /></svg>
            {email}
          </a>
        ))}
        <a href={cv.contact.web} class="inline-flex items-center gap-1 text-gray-700">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5a17.92 17.92 0 0 1-8.716-2.247m0 0A9 9 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418" /></svg>
          {cv.contact.web.replace("https://", "")}
        </a>
        <a href={cv.contact.github} class="inline-flex items-center gap-1 text-gray-700">
          <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12Z" /></svg>
          {cv.contact.github.replace("https://", "")}
        </a>
        <a href={cv.contact.linkedin} class="inline-flex items-center gap-1 text-gray-700">
          <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286ZM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065Zm1.782 13.019H3.555V9h3.564v11.452ZM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003Z" /></svg>
          {cv.contact.linkedin.replace("https://www.", "")}
        </a>
      </div>
      <div class="mt-6 print:hidden">
        <button
          id="print-btn"
          type="button"
          class="inline-flex items-center px-4 py-2 rounded-lg border border-slate-700 hover:border-slate-500 text-slate-300 hover:text-slate-100 text-sm transition-colors gap-2 cursor-pointer"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m0 0a48.09 48.09 0 0 1 10.5 0m-10.5 0V5.625c0-.621.504-1.125 1.125-1.125h8.25c.621 0 1.125.504 1.125 1.125v2.034" />
          </svg>
          Print / Save PDF
        </button>
      </div>
    </header>

    <!-- Education -->
    <section class="cv-section mb-10">
      <h2 class="cv-section-heading text-xs font-mono text-slate-400 uppercase tracking-widest mb-6 pb-2 border-b border-slate-800 print:text-gray-500 print:border-gray-300">
        Education
      </h2>
      <div class="space-y-4">
        {cv.education.map((edu) => (
          <div class="cv-entry grid grid-cols-[8rem_1fr] gap-4 text-sm sm:grid-cols-[9rem_1fr]">
            <span class="text-slate-500 print:text-gray-500 font-mono text-xs pt-0.5 whitespace-nowrap">
              {edu.years}
            </span>
            <div>
              <p class="text-slate-100 print:text-black font-medium">
                {edu.degree}, {edu.institution}
              </p>
              {edu.detail && (
                <p class="text-slate-400 print:text-gray-600 mt-0.5">{edu.detail}</p>
              )}
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Employment -->
    <section class="cv-section mb-10">
      <h2 class="cv-section-heading text-xs font-mono text-slate-400 uppercase tracking-widest mb-6 pb-2 border-b border-slate-800 print:text-gray-500 print:border-gray-300">
        Employment History
      </h2>
      <div class="space-y-6">
        {cv.employment.map((job) => (
          <div class="cv-entry grid grid-cols-[8rem_1fr] gap-4 text-sm sm:grid-cols-[9rem_1fr]">
            <span class="text-slate-500 print:text-gray-500 font-mono text-xs pt-0.5 whitespace-nowrap">
              {job.years}
            </span>
            <div>
              <p class="text-slate-100 print:text-black font-medium">
                {job.title}
              </p>
              <p class="text-slate-400 print:text-gray-600">{job.org}</p>
              {job.bullets && job.bullets.length > 0 && (
                <ul class="mt-1.5 space-y-1 text-slate-400 print:text-gray-600">
                  {job.bullets.map((bullet) => (
                    <li class="flex items-start gap-2">
                      <span class="text-slate-600 print:text-gray-400 mt-0.5 flex-shrink-0">&middot;</span>
                      <span>{bullet}</span>
                    </li>
                  ))}
                </ul>
              )}
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Publications: Articles -->
    <section class="cv-section mb-10">
      <h2 class="cv-section-heading text-xs font-mono text-slate-400 uppercase tracking-widest mb-6 pb-2 border-b border-slate-800 print:text-gray-500 print:border-gray-300">
        Research Publications
      </h2>

      <h3 class="text-sm font-semibold text-slate-300 print:text-gray-700 mb-4">Articles</h3>
      <ol class="space-y-3 text-sm">
        {cv.publications.articles.map((pub, i) => (
          <li class="cv-pub grid grid-cols-[2rem_1fr] gap-2">
            <span class="text-slate-600 print:text-gray-400 font-mono text-xs text-right pt-0.5">
              {i + 1}.
            </span>
            <div>
              <span class="text-slate-400 print:text-gray-600" set:html={highlightName(pub.authors)} />.
              <span class="text-slate-200 print:text-gray-900">{pub.title}.</span>
              {" "}<em class="text-slate-400 print:text-gray-600">{pub.venue}</em>{pub.volume ? `, ${pub.volume}` : ""}{pub.pages ? `, ${pub.pages}` : ""}, {pub.year}.
              {pub.doi && (
                <a
                  href={`https://doi.org/${pub.doi}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-accent hover:text-accent-light print:text-blue-700 transition-colors ml-1"
                >
                  doi
                </a>
              )}
            </div>
          </li>
        ))}
      </ol>

      <!-- Theses -->
      <h3 class="text-sm font-semibold text-slate-300 print:text-gray-700 mb-4 mt-8">Theses</h3>
      <ol class="space-y-3 text-sm">
        {cv.publications.theses.map((pub, i) => (
          <li class="cv-pub grid grid-cols-[2rem_1fr] gap-2">
            <span class="text-slate-600 print:text-gray-400 font-mono text-xs text-right pt-0.5">
              {i + 1}.
            </span>
            <div>
              <span class="text-slate-400 print:text-gray-600" set:html={highlightName(pub.authors)} />.
              <span class="text-slate-200 print:text-gray-900">{pub.title}.</span>
              {" "}<em class="text-slate-400 print:text-gray-600">{pub.venue}</em>, {pub.year}.
            </div>
          </li>
        ))}
      </ol>

      <!-- Presentations -->
      <h3 class="text-sm font-semibold text-slate-300 print:text-gray-700 mb-4 mt-8">Selected Presentations and Posters</h3>
      <ol class="space-y-3 text-sm">
        {cv.publications.presentations.map((pub, i) => (
          <li class="cv-pub grid grid-cols-[2rem_1fr] gap-2">
            <span class="text-slate-600 print:text-gray-400 font-mono text-xs text-right pt-0.5">
              {i + 1}.
            </span>
            <div>
              <span class="text-slate-400 print:text-gray-600" set:html={highlightName(pub.authors)} />.
              <span class="text-slate-200 print:text-gray-900">{pub.title}.</span>
              {" "}<em class="text-slate-400 print:text-gray-600">{pub.venue}</em>, {pub.year}.
            </div>
          </li>
        ))}
      </ol>
    </section>

    <!-- Service -->
    <section class="cv-section mb-10">
      <h2 class="cv-section-heading text-xs font-mono text-slate-400 uppercase tracking-widest mb-6 pb-2 border-b border-slate-800 print:text-gray-500 print:border-gray-300">
        Service
      </h2>
      <div class="space-y-4">
        {cv.service.map((item) => (
          <div class="cv-entry grid grid-cols-[8rem_1fr] gap-4 text-sm sm:grid-cols-[9rem_1fr]">
            <span class="text-slate-500 print:text-gray-500 font-mono text-xs pt-0.5 whitespace-nowrap">
              {item.years}
            </span>
            <div>
              <p class="text-slate-100 print:text-black font-medium">{item.role}</p>
              {item.detail && (
                <p class="text-slate-400 print:text-gray-600 mt-0.5">{item.detail}</p>
              )}
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Awards -->
    <section class="cv-section mb-10">
      <h2 class="cv-section-heading text-xs font-mono text-slate-400 uppercase tracking-widest mb-6 pb-2 border-b border-slate-800 print:text-gray-500 print:border-gray-300">
        Awards
      </h2>
      <div class="space-y-3">
        {cv.awards.map((award) => (
          <div class="cv-entry grid grid-cols-[8rem_1fr] gap-4 text-sm sm:grid-cols-[9rem_1fr]">
            <span class="text-slate-500 print:text-gray-500 font-mono text-xs pt-0.5 whitespace-nowrap">
              {award.year}
            </span>
            <div>
              <p class="text-slate-100 print:text-black font-medium">{award.title}</p>
              {award.detail && (
                <p class="text-slate-400 print:text-gray-600 mt-0.5">{award.detail}</p>
              )}
            </div>
          </div>
        ))}
      </div>
    </section>

  </article>

  <script is:inline>
    document.addEventListener("DOMContentLoaded", function () {
      var btn = document.getElementById("print-btn");
      if (btn) btn.addEventListener("click", function () { window.print(); });
    });
  </script>
</Layout>
